<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <title>Bin | Stepik Delivery</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style>
    /* Sticky footer styles
    -------------------------------------------------- */
    html {
      position: relative;
      min-height: 100%;
    }
    body {
      margin-bottom: 60px; /* Margin bottom by footer height */
    }
    .footer {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 60px; /* Set the fixed height of the footer here */
      line-height: 60px; /* Vertically center the text there */
    }
    .navbar {
      padding-top: 0;
      padding-bottom: 0;
    }

  </style>
</head>

<body>
  <header class="container">
    {% include "navigation.html" %}
  </header>
  <main class="container">
    <h1 class="h3 my-4">Корзина</h1>

    {% if request.args['action'] == 'remove' %}
    <div class="alert alert-warning" role="alert">Блюдо удалено из корзины</div>
    {% endif %}
    {% if not session['is_auth'] %}
    <div class="alert alert-warning" role="alert">Чтобы сделать заказ – <a href="{{ url_for('render_login') }}">войдите</a> или <a
        href="{{ url_for('render_register') }}">зарегистрируйтесь</a></div>
    {% endif %}
    <div class="row mt-5">

      <div class="col-4">
        <form action="{{ url_for('render_cart') }}" method="POST" novalidate>
          {{ form.csrf_token }}
          <h4 class="">Ваши данные</h4>
          <div class=" md-4 order-md-1">

            {{ form.client_name.label }}
            {{ form.client_name(class_="form-control") }}

            {{ form.client_mail.label }}
            {{ form.client_mail(class_="form-control") }}

            {{ form.client_phone.label }}
            {{ form.client_phone(class_="form-control") }}

            {{ form.client_address.label }}
            {{ form.client_address(class_="form-control") }}

            {% if form.errors %}
              <ul class="errors">
                {% for field_name, field_errors in form.errors|dictsort if field_errors %}
                  {% for error in field_errors %}
                    <li>{{ form[field_name].label }}: {{ error }}</li>
                  {% endfor %}
                {% endfor %}
              </ul>
            {% endif %}
          </div>

          {% if session['is_auth'] %}
          <button type="submit" class=" mt-3 mb-5 btn btn-danger">Оформить заказ</button>
          {% endif %}
        </form>
      </div>

      <div class="col-7">
        <h4 class="mb-3 col-7 mb-5">{{meals|length}} блюда в корзине</h4>
        <table class="table">
          <tbody>
          {% for meal in meals %}
          <tr>
            <th scope="row">{{meal['title']}}"</th>
            <td></td>
            <td>1</td>
            <td>{{meal['price']}}</td>
            <td>
              <form action="{{ url_for('render_delete') }}" method="POST">
                <input type="hidden" name="meal_id" value="{{meal['id']}}"/>
                <button type="submit" class="btn btn-outline-danger btn-sm">Удалить</button>
              </form>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
        <hr>
        <p class="display-4 my-2 ">{{ session['total']|default(0) }} руб</p>
      </div>
    </div>

  </main>
  <footer class="footer">
    <nav class="container navbar navbar-light bg-light">
      <ul class="navbar-nav mr-auto">
        <p class="h4 nav-link">Stepik Delivery</p>
      </ul>
      <a class="text-muted" href="#">Project author 2020</a>
    </nav>
  </footer>
</body>
